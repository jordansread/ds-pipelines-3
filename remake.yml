target_default: main

packages:
  - tidyverse
  - dataRetrieval
  - urbnmapr

sources:
  - 1_fetch/src/find_oldest_sites.R
  - 1_fetch/src/get_site_data.R
  - 3_visualize/src/map_sites.R

targets:
  main:
    depends:
      - 3_visualize/out/site_map.png
      - wi_data
      - mn_data
      - mi_data

  # Configuration
  states:
    command: c(I(c('WI','MN','MI')))
  parameter:
    command: c(I('00060'))

  wi_data:
    command: get_site_data(oldest_active_sites, state = I("WI"), parameter = parameter)

  mn_data:
    command: get_site_data(oldest_active_sites, state = I("MN"), parameter = parameter)

  mi_data:
    command: get_site_data(oldest_active_sites, state = I("MI"), parameter = parameter)

  # Identify oldest sites
  oldest_active_sites:
    command: find_oldest_sites(states, parameter)

  # PULL SITE DATA HERE


  # Map oldest sites
  3_visualize/out/site_map.png:
    command: map_sites(oldest_active_sites, target_name)
